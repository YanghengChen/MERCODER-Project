<!DOCTYPE html>
<html lang="en">

<head>
    <%- include('../partials/navbar'); %>
	<link href="../css/mdb.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">

  <!-- Core Bootstrap JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.min.js" integrity="sha384-cuYeSxntonz0PPNlHhBs68uyIAVpIIOZZ5JqeqvYYIcEL727kskC66kF92t6Xl2V" crossorigin="anonymous"></script>
  <!-- Font Awesome icons (free version)-->
  <script src="https://use.fontawesome.com/releases/v6.3.0/js/all.js" crossorigin="anonymous"></script>
  <!-- Google fonts-->
  <link href="https://fonts.googleapis.com/css?family=Catamaran:100,200,300,400,500,600,700,800,900" rel="stylesheet" />
  <link href="https://fonts.googleapis.com/css?family=Lato:100,100i,300,300i,400,400i,700,700i,900,900i" rel="stylesheet" />
</head>

<body>

<div class="p-3 mb-2 bg-light bg-gradient text-dark">

<center>
	<h1>Problem Worldmap</h1>
</center>
 
 <!-- Search bar -->
 <section class="p-4 text-center w-100">
          <div class="d-grid gap-2 col-6 mx-auto">
            <div class="input-group">
				<div class="form-outline">
					<input type="search" id="form1" class="form-control" />
					<label class="form-label" for="form1">Search</label>
				</div>
			</div>
            <button type="button" class="btn btn-outline-dark">Search</button>
          </div>
 </section>

<!-- Map declaration, looping through prob locations.  -->
<div id="googleMap" style="width:90%;height:800px; margin: 0 auto;"></div>


<!-- eslint-disable-next-script -->
<script>
  var locArray = <%= mapData%>; 

  function myMap() {
    var mapProp= {
      center:new google.maps.LatLng(37.0902,-95.7129),
      zoom:5,
    };

    var map = new google.maps.Map(document.getElementById("googleMap"), mapProp);

    for (let i = 0; i < locArray.length; i++) {
      let probMark = new google.maps.Marker({position:new google.maps.LatLng(locArray[i].lat, locArray[i].lng)});
      probmark.setMap(map);
      let infowindow = new google.maps.InfoWindow({content:locArray[i].probID});
      google.maps.event.addListener(probMark, 'click', function () { infowindow.open(map, probmark);});

      google.maps.event.addListener(probMark, 'click', function () {
              var pos = map.getZoom();
              map.setZoom(15);
              map.setCenter(probMark.getPosition());
              map.setCenter(probMark.getPosition());
              window.setTimeout(function() {map.setZoom(pos);}, 3000);
      });
    }
  }
</script>

<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyC_qLDP04emk0-Vs2WHkg9tz0t4vT24dhw&callback=myMap"></script>

<br>

</div>
</body>
</html>